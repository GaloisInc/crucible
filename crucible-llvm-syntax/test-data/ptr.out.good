(defun @test-ptr () (Ptr 64)
   (start start:
      (let blk0 (the Nat 0))
      (let off0 (bv 64 0))
      (let p0 (ptr 64 blk0 off0))
      (let p (ptr-ite 64 #t p0 p0))
      (let blk (ptr-block 64 p))
      (let off (ptr-offset 64 p))
      (assert! (equal? blk0 blk) "block numbers equal")
      (assert! (equal? off0 off) "offsets equal")
      (let sz (bv 64 1))
      (let a (alloca none sz))
      (let vblk0 (the Nat 0))
      (let voff0 (bv 8 255))
      (let v0 (ptr 8 vblk0 voff0))
      (store none i8 a v0)
      (let v (load none i8 a))
      (let vblk (ptr-block 8 v))
      (let voff (ptr-offset 8 v))
      (assert! (equal? vblk0 vblk) "stored block numbers equal")
      (assert! (equal? voff0 voff) "stored offsets equal")
      (let g (resolve-global "malloc"))
      (let h (load-handle (Ptr 64) ((Ptr 64)) g))
      (return p)))

test-ptr
%0
  % 3:15
  $0 = natLit(0)
  % 4:15
  $1 = bVLit(64, BV 0)
  % 5:13
  $2 = extensionApp(pointerExpr $0 $1)
  % 6:12
  $3 = boolLit(True)
  % 6:12
  $4 = extensionApp(pointerIte $3 $2 $2)
  % 7:14
  $5 = extensionApp(pointerBlock $4)
  % 8:14
  $6 = extensionApp(pointerOffset $4)
  % 9:14
  $7 = natEq($0, $5)
  % 9:32
  $8 = stringLit("block numbers equal")
  % 9:5
  assert($7, $8)
  % 10:14
  $9 = baseIsEq(BaseBVRepr 64, $1, $6)
  % 10:32
  $10 = stringLit("offsets equal")
  % 10:5
  assert($9, $10)
  % 12:13
  $11 = bVLit(64, BV 1)
  % 13:12
  $12 = alloca crucible-llvm-syntax-test-memory $11 Alignment 0 test-data/ptr.cbl:13:12
  % 15:16
  $13 = bVLit(8, BV 255)
  % 16:13
  $14 = extensionApp(pointerExpr $0 $13)
  % 17:5
  $15 = store crucible-llvm-syntax-test-memory $12 bitvectorType 1 Alignment 0 $14
  % 18:12
  $16 = load crucible-llvm-syntax-test-memory $12 bitvectorType 1 Alignment 0
  % 19:15
  $17 = extensionApp(pointerBlock $16)
  % 20:15
  $18 = extensionApp(pointerOffset $16)
  % 21:14
  $19 = natEq($0, $17)
  % 21:34
  $20 = stringLit("stored block numbers equal")
  % 21:5
  assert($19, $20)
  % 22:14
  $21 = baseIsEq(BaseBVRepr 8, $13, $18)
  % 22:34
  $22 = stringLit("stored offsets equal")
  % 22:5
  assert($21, $22)
  % 24:12
  $23 = resolveGlobal crucible-llvm-syntax-test-memory "malloc"
  % 25:12
  $24 = loadFunctionHandle crucible-llvm-syntax-test-memory $23 as Nothing
  % 27:5
  return $4
  % no postdom
